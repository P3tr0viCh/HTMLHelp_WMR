<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<title>Использование</title>
	<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
	<meta name="Author" content="П3тр0виЧъ">
</head>

<body>
<H1>2 Использование</H1>
Работа с программным обеспечением начинается с запуска исполняемого модуля "WMR.exe".
Перед началом работы с программой необходимо зарегистрироваться путём выбора пользователя в
окне "Вход в программу".

<H2><a name="P_2_1">2.1 Вход в программу</a></H2>
<img src="frmLogin.png" alt="Вход в систему" align="center" vspace=10><br>
В данном окне пользователь должен выбрать своё имя из списка и ввести пароль
(если необходимо) в соответствующее поле ввода. Для окончания регистрации и
начала работы с программой следует нажать кнопку "ОК". В случае нажатия на
кнопку "Закрыть"  и подтверждения этого действия произойдёт закрытие программы.
<p>
Список имён и паролей создаётся
заранее в <a href="Options.htm#P_4_11">настройках</a>.
При первоначальном запуске программы имеется только один пользователь
"Администратор" с правом доступа к настройкам.

<H2><a name="P_2_2">2.2 Главное окно</a></H2>
После регистрации на экране появляется основное окно программы, показанное ниже.<br>
<img src="frmMain.png" alt="Основное окно" align="center" vspace=10><br>
Окно содержит кнопки, объединённые в группы. Клавиша, позволяющая воспользоваться
определённой кнопкой при помощи клавиатуры без применения графического манипулятора (мыши),
указана в надписи на кнопке (в круглых скобках).
<p>
Группа "Взвешивание" предоставляет выбор различных режимов взвешивания:
<a href="Using.htm#P_2_3">ручной</a>,
<a href="Using.htm#P_2_4">автоматический</a> или
<a href="Using.htm#P_2_5">автоматический в режиме "Веском"</a>.<br>
Видимость кнопок зависит от <a href="Options.htm#P_4_1">настроек</a>.
<p>
Группа "База данных" даёт доступ к данным, хранящимся в таблицах базы.
Кнопка "Вагоны&nbsp;(F6)" показывает <a href="Using.htm#P_2_8">список всех провешенных вагонов</a>,
как гружёных, так и порожних.
Кнопка "Тары&nbsp;(F7)" &ndash; <a href="Using.htm#P_2_9">список порожних вагонов</a>.
Кнопка "Печь&nbsp;&ndash;&nbsp;выпуск&nbsp;(F10)" &ndash;
<a href="Using.htm#P_2_10">список печей</a>.
<p>
В группе "Пользователь" находится поле с именем пользователя, зарегистрированного
в программе, и кнопка "Сменить&nbsp;(F12)", позволяющая сменить текущего пользователя.
При нажатии на эту кнопку вызывается диалог <a href="Using.htm#P_2_1">"Вход в программу"</a>.
<p>
Группа "Дополнительно" содержит две кнопки. "Калькулятор" запускает стандартный
калькулятор Windows. "Справка" открывает справочную систему. Справка 
является контекстнозависимой, то есть, нажатие клавиши F1 в различных
окнах открывает раздел справки, относящийся к этому окну.
<p>
В группе "Другое" находятся кнопки "Настройки", "О программе" и "Закрыть".
Кнопка "Настройки" даёт доступ
к <a href="Options.htm">настройкам</a> программы. Данная кнопка доступна и видима
только пользователю "Администратор". Кнопка "Закрыть" закрывает программу, при этом показывается
диалог, в котором нужно подтвердить данное действие.

<H2><a name="P_2_3">2.3 Ручное взвешивание</a></H2>
В режиме ручного взвешивания данные поступают от весоизмерительного прибора CAS
после нажатия на подсоединённый к нему выключатель. Нажатие на выключатель необходимо
выполнять при нахождении взвешиваемого вагона в центре весовой платформы.<br>
После провешивания состава нужно нажать на кнопку "Остановить" для перехода
в режим <a href="Using.htm#P_2_6">редактирования</a> состава.
<img src="frmWeightManual.png" alt="Ручное взвешивание" align="center" vspace=10><br>

<H2><a name="P_2_4">2.4 Автоматическое взвешивание</a></H2>
В режиме автоматического взвешивания данные поступают от весоизмерительного прибора CAS
после срабатывания путевого датчика.<br>
Перед началом взвешивания отображается диалог выбора параметров взвешивания,
в котором нужно задать направление движения состава, позицию тепловоза и
количество осей у тепловоза. Для верного определения веса выбранные параметры
должны соответствовать реальным.<br>
На окне схематично отображается вид состава. Вид вагона зависит от
<a href="Options.htm#P_4_10">настроек</a>.
Положение вагона и тепловоза
изменяется при смене параметров взвешивания. Различные виды этого окна показаны ниже.<br>
Изменять параметры взвешивания можно не только выбором переключателей в
соответствующих группах, но и нажатием на рисунки состава. При этом нажатие на
локомотив изменяет количество его осей, нажатие на вагон меняет позицию тепловоза и
нажатие на стрелку &ndash; направление движения.<br>
Взвешивание начинается после нажатия на кнопку "ОК".<br>
После закрытия окна выбора параметров, на экран выводится окно, аналогичное окну провески
в <a href="Using.htm#P_2_3">ручном</a> режиме.
<p>
Во время провески весовщик обязан контролировать правильность взвешивания:
значение веса в списке должно появляться в момент положения вагона точно
на середине весовой платформы. Появление веса в другое время означает,
что были выбраны неверные параметры взвешивания (в заголовке окна провески отображается
выбранное направления движения), либо произошел аппаратный сбой.
<p>
После провешивания состава нужно нажать на кнопку "Остановить" для перехода
в режим <a href="Using.htm#P_2_6">редактирования</a> состава. Нажимать на кнопку
необходимо только после полного съезда всего состава (включая тепловоз) с платформы весов.
<img src="frmWeightAutoParamsLTRLF4.png" alt="Автоматическое взвешивание" align="center" vspace=10><br>
<img src="frmWeightAutoParamsRTLLL4.png" alt="Автоматическое взвешивание" align="center" vspace=10><br>
<img src="frmWeightAutoParamsRTLLF6.png" alt="Автоматическое взвешивание" align="center" vspace=10><br>
<img src="frmWeightAutoParamsLTRLF4M.png" alt="Автоматическое взвешивание" align="center" vspace=10><br>
<p>
<b>Принцип работы автоматического взвешивания.</b><br>
Во время движения состава каждая ось вагона или тепловоза нажимает путевой датчик,
установленный на платформе весов с левой стороны. При этом в программу поступает
значение веса. В зависимости от выбранных параметров взвешивания учитывается
только значение веса в тот момент, когда вагон находится точно на середине платформы.
Например, во время движения чугуновозных ковшей слева направо с тепловозом в начале состава,
сначала пропускаются первые четыре значения веса (четыре оси тепловоза),
а затем каждые три оси (так как вагон четырехосный). Вес в программу заносится
на каждую четвертую ось.
Если ковши движутся справа налево (тепловоз, соответственно, в конце состава),
взвешивание начинается с первой оси, и затем происходит через каждые три пропущенные оси.
При этом также в программу заносится неправильный вес тепловоза, но после остановки
взвешивания из списка удаляется последний вагон, который на деле и является тепловозом.

<H2><a name="P_2_5">2.5 Автоматическое взвешивание в режиме "Веском"</a></H2>
В данном режиме данные поступают от модуля "Динамика", работающего с программно-аппаратным
обеспечением вагонных весов производства ООО "Веском".<br>
Перед началом и во время взвешивания на экран выводится показанное ниже окно.<br>
<img src="frmWeightVescomNoModule.png" alt="Автоматическое взвешивание" align="center" vspace=10><br>
Надпись "Нет связи с модулем" или "Нет связи с терминалом" в этом окне означает, что
во время запуска процедуры взвешивания произошла ошибка, связанная с программно-аппаратным
обеспечением вагонных весов. Взвешивание при этом не происходит.<br>
В случае удачного запуска взвешивания, выводится надпись "Ожидание состава".
При наезде состава на весовую платформу, на экран выводится надпись "Идёт взвешивание".
После съезда состава и прохождения десяти секунд (зависит от настроек модуля "Динамика"),
выводится надпись "Чтение состава", через пять секунд окно взвешивания автоматически закрывается и
на экран выводится окно <a href="Using.htm#P_2_6">редактирования</a>.<br>
Нажатие на кнопку "Отмена" прерывает процесс взвешивания.

<H2><a name="P_2_6">2.6 Редактирование состава</a></H2>
Окно предназначено для редактирования состава.<br>
Кнопки "Тара из базы" и "Тара в базу" предназначены для получения веса порожних вагонов
из базы данных и сохранения этого веса в базу. Нажатие на кнопки вызывает
<a href="Using.htm#P_2_7">окно работы с тарой</a>. Работа с тарой ведётся только с
выделенными в списке вагонами.
Если в списке нет выделения, автоматически выделяются все строки.<br>
Кнопка "Добавить" добавляет строку в список. Данная кнопка доступна только администратору.<br>
Кнопка "Удалить" позволяет удалить выбранные строки из списка.
Данная кнопка доступна, если в <a href="Options.htm#P_4_1">настройках</a>
установлено разрешение на удаление записей.<br>
Кнопка "Закрыть" закрывает окно, при этом, если в не было сделано никаких изменений,
окно закрывается без подтверждения. В случае, если были внесены какие-либо изменения, или
окно показано после взвешивания состава в режиме "Веском" на экран выводится диалог, в котором
нужно подтвердить свои действия.<br>
<img src="msgTrainSave.png" alt="Редактирование состава" align="center" vspace=10><br>
Нажатие на кнопку "Да" сохраняет данные и закрывает окно редактирования, нажатие "Нет" &ndash;
закрывает окно редактирования без сохранения внесённых изменений.
Нажатие кнопки "Отмена" позволяет продолжить работу в окне редактирования
не закрывая его.<br>
При необходимости сохранить данные без редактирования можно принудительно
вызвать диалог подтверждения зажатием клавиши "Shift" при нажатии на кнопку "Закрыть".<br>
Редактирование данных выполняется путём внесения значений в поля ввода "№ выпуска",
"№ вагона", "Тара до" и "Тара после" или
выбором в списках "№ печи", "Тип вагона", "Род груза" и "Получатель". Содержание
списков задаётся в соответствующих вкладках <a href="Options.htm#P_4_6">настроек</a>.<br>
Поля и списки становятся доступны после выбора одной или нескольких строк,
при этом вносимые изменения применяются ко всем выделенным строкам.<br>
Значения "Тары до" и "Тары после" можно изменять как вручную путём внесения значений в
соответствующие поля, так и загружать из базы путём нажатия кнопок "Тара из базы" или
"Тару в базу".<br>
При изменении значений в колонке "Тара до" или "Тара после" автоматически вычисляются
колонки "Потери", "Нетто" и "Чистый вес". Вес "Потери" равен весу "Тара до" минус
вес "Тара после". Вес "Нетто" равен весу "Брутто" минус вес "Тара до".
"Чистый вес" равен весу "Брутто" минус вес "Тара после".<br>
Поля "Дата", "Брутто" и "Скорость" доступны для редактирования только администратору.<br>
В полях группы "Общий вес выделенных записей" выводятся суммы значений в соответствующих
колонках списка строк, при этом, если в списке нет выделения, отображаются суммы для
всех вагонов состава.<br>
<img src="frmTrainEdit1.png" alt="Редактирование состава" align="center" vspace=10><br>
<img src="frmTrainEdit2.png" alt="Редактирование состава" align="center" vspace=10><br>
В колонке "Сеть" показывается "+", если строка сохранена на ИСВС, и "-", если
сохранение не выполнено.
Колонка "DATETIME" показывается только администратору.

<H2><a name="P_2_7">2.7 Редактирование тары</a></H2>
Окно предназначено для подтверждения замены значения тары в окне
<a href="Using.htm#P_2_6">редактирования</a> при получении веса порожних вагонов
из базы данных или сохранения веса в базу.<br>
Окно "Чтение тары" показывается при загрузке веса тары. В нём нужно выбрать
тип тары, которая будет заменена полученным из базы значением, и подтвердить
выбор нажатием кнопки "Да".<br>
<img src="frmTaresLoad.png" alt="Загрузка тары" align="center" vspace=10><br>
Окно "Сохранение тары" показывается при сохранении веса тары. В нём нужно
подтвердить сохранение нажатием кнопки "Да", при этом значение "Тары до" в окне
<a href="Using.htm#P_2_6">редактирования</a> будет заменено на значение, хранящееся
в базе данных, а вес "Тары после" станет равным весу "Брутто" и сохранится в базе.<br>
<img src="frmTaresSave.png" alt="Сохранение тары" align="center" vspace=10><br>

<H2><a name="P_2_8">2.8 Список провешенных вагонов</a></H2>
Окно содержит список всех вагонов, провешенных на данном весовом пункте.<br>
Записи загружаются из локальной базы. Кроме этого, в списке также могут отображаться
вагоны, провешенные на других весовых пунктах, указанных в
<a href="Options.htm#P_4_3">поле</a> "Дополнительно отображать данные со следующих весов".<br>
Нажатие кнопки "Изменить" позволяет редактировать данные вагонов выделенного состава при
помощи <a href="Using.htm#P_2_6">окна редактирования</a>. Выделять все вагоны состава
для этого не надо, достаточно выбрать один вагон. Кроме кнопки "Изменить" редактирование
можно начать двойным щелчком по списку вагонов. Редактировать можно только составы,
провешенные на данном весовом пункте, попытка изменить другие составы просто
выделит вагоны такого состава.<br>
Кнопка "Обновить" или нажатие клавиши F5 перезагружает список вагонов.<br>
Кнопка "Фильтр" показывает окно, при помощи которого можно задать период,
за который будут отображаться данные.<br>
<img src="frmFilter.png" alt="Фильтр" align="center" vspace=10><br>
Для этого в нём нужно выбрать переключатель "Отрезок времени" и в соответствующих
полях указать даты начала и окончания периода, после чего нажать кнопку "Применить".
Время начала периода &ndash; начало суток, то есть время 00:00:00. Время окончания &ndash;
конец суток, то есть 23:59:59. Также, предопределённые даты можно выбрать в контекстном меню,
вызываемом нажатием правой клавиши мыши на полях ввода даты.<br>
<img src="frmFilterMenu.png" alt="Фильтр" align="center" vspace=10><br>
Нажатие кнопки "Очистить" или выбор переключателя "Все записи" и нажатие
кнопки "Применить" отключает фильтр, то есть выводятся все имеющиеся в базе данных записи.<br>
Использующийся фильтр показывается в группе "Фильтр".<br>
В полях группы "Общий вес выделенных записей" выводятся суммы значений в
соответствующих колонках списка строк, при этом, если в списке нет выделения,
отображается общая сумма для всех вагонов.<br>
Записи сортируются по дате и времени провески в порядке убывания и группируются
по составам. Вагоны, принадлежащие одному составу, выделяются общим цветом, при этом
цвет чередуется. Кроме этого, первыми в списке всегда идут вагоны, не сохранённые на ИСВС.
Такие вагоны выделяются красным цветом.<br>
<img src="frmTrains1.png" alt="Список вагонов" align="center" vspace=10><br>
<img src="frmTrains2.png" alt="Список вагонов" align="center" vspace=10><br>
<img src="frmTrains3.png" alt="Список вагонов" align="center" vspace=10><br>
Колонка "Весовая" показывает название весового пункта, на котором был провешен вагон.<br>
Колонка "Направление" показывает направление состава при взвешивании, символы ">>>"
означают движение слева-направо.<br>
В колонке "Сеть" показывается "+", если строка сохранена на ИСВС, и "-", если
сохранение не выполнено.
Колонки "SCALES", "NUM", "START" и "TRNUM" показываются только администратору.

<H2><a name="P_2_9">2.9 Список порожних вагонов</a></H2>
В списке отображаются данные из сетевой базы ИСВС, если в
<a href="Options.htm#P_4_3">настройках</a> включен
переключатель "Сохранять и загружать тару с сервера" или
из локальной базы, если переключатель выключен.<br>
Если отображаются данные с ИСВС, то кроме вагонов, провешенных на данном
весовом пункте, показываются вагоны, провешенные на пунктах, указанных
в <a href="Options.htm#P_4_3">поле</a> "Дополнительно отображать данные со следующих весов".<br>
Колонка "Весовая" показывает название весового пункта, на котором был провешен
порожний вагон.<br>
Записи сортируются по номеру вагона.<br>
<img src="frmTares.png" alt="Список тар" align="center" vspace=10><br>
Колонки "SCALES" и "WTIME/INDEX" показываются только администратору.

<H2><a name="P_2_10">2.10 Список печей</a></H2>
В окне показывается список печей и соответствующие им номера выпуска.<br>
В списке отображаются данные из сетевой базы ИСВС, если в
<a href="Options.htm#P_4_3">настройках</a> включен
переключатель "Сохранять и загружать номер выпуска с сервера" или
из локальной базы, если переключатель выключен.<br>
Записи сортируются по номеру печи.<br>
<img src="frmBakes.png" alt="Список печей" align="center" vspace=10><br>

<H2><a name="P_2_11">2.11 Протоколирование работы</a></H2>
Для учёта действий, совершаемых как пользователем, так и программой, а также для
сохранения сообщений об ошибках используется лог-файл.<br>
Формат файла &ndash; текстовый,
каждое событие записывается на отдельной строке. При превышении размера лога
порога в один мегабайт файл автоматически переименовывается с добавлением даты и
времени переименования в формате "год-месяц-день час-минуты-секунды", после чего
создаётся новый файл, в который ведётся запись. Количество
одновременно хранящихся лог-файлов неограничено. Файлы хранятся в папке log,
которая находится в рабочем каталоге программы. В случае отсутствия данной папки, она
создаётся автоматически.

<hr>
<div align="right">© Дураев Константин Петрович, 2014.</div>
</body>
</html>
